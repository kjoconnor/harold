{% extends "base.html" %}
{% import "utils.html" as utils %}

{% block content %}
<section class="listing">
  <h2>waiting for author</h2>

  {% for state in ["fish", "eyeglasses", "nail_care"]: %}
  <details open>
    <summary>
      <h3 class="state-{{ state }}">{{ state_meanings[state] }} <span>({{ pull_requests[state] | length }})</span></h3>
    </summary>

    {% for pull_request in pull_requests[state]: %}
    <div class="pull-request">
      <ul class="review-states">
        {% for user, state in pull_request.current_states().iteritems(): %}
          <li title="@{{ user }}: {{ state_meanings[state.state] }}" class="state state-{{ state.state }}"><a href="/user/{{user}}" target="_self">:{{ state.state }}:</a></li>
        {% endfor %}
      </ul>

      <h4>{{ utils.truncated_title(pull_request.title, pull_request.url) }}</h4>

      <p class="tagline">
        {{ utils.timestamp(pull_request.created) }}
        &middot;
        <a href="/user/{{ pull_request.author }}" target="_self">@{{ pull_request.author }}</a>
        &middot;
        <a href="/repo/{{ pull_request.repository }}" target="_self">{{ pull_request.repository }}</a>#{{ pull_request.id }}
      </p>
    </div>
    {% endfor %}
  </details>
  {% endfor %}
</section>

<section class="listing">
  <h2>waiting for reviewers</h2>

  {% for state in ["haircut", "unreviewed"]: %}
  <details open>
    <summary>
      <h3 class="state-{{ state }}">{{ state_meanings[state] }} <span>({{ pull_requests[state] | length }})</span></h3>
    </summary>

    {% for pull_request in pull_requests[state]: %}
    <div class="pull-request">
      <ul class="review-states">
        {% for user, state in pull_request.current_states().iteritems(): %}
          <li title="@{{ user }}: {{ state_meanings[state.state] }}" class="state state-{{ state.state }}"><a href="/user/{{user}}" target="_self">:{{ state.state }}:</a></li>
        {% endfor %}
      </ul>

      <h4>{{ utils.truncated_title(pull_request.title, pull_request.url) }}</h4>

      <p class="tagline">
        {{ utils.timestamp(pull_request.created) }}
        &middot;
        <a href="/user/{{ pull_request.author }}" target="_self">@{{ pull_request.author }}</a>
        &middot;
        <a href="/repo/{{ pull_request.repository }}" target="_self">{{ pull_request.repository }}</a>#{{ pull_request.id }}
      </p>
    </div>
    {% endfor %}
  </details>
  {% endfor %}
</section>
{% endblock %}
